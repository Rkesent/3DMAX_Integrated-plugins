
<aside>
😀 开发原因：

在多人协作完成模型开发时，会发现在归档文件时出现大量的重复文件，造成大量的资源浪费，在归档集中时处理重复文件大量重复操作及其费时和消耗精力，所有萌生了开发一个脚本来解决这个问题的想法。

</aside>

## 显示不是很好可以看博客中的内容
[博客地址](:https://xn--yet6ex33e4wa.cn/article/max)

# 📝 正文

## 基本功能

1. 检测丢失贴图（核心功能）
2. 替换丢失贴图（基于检测结果）
3. 更换贴图路径（基于检测结果另一种处理结果）
4. 修复贴图尺寸（基于**勾选贴图大小检测**功能的检测结果）
5. 转换为（标准/VR）材质
- 6.重命名工具
    
    - 模型重命名
    
    - 贴图重命名
    
    - 将贴图名称作为材质名称
    
    - 贴图归档（可选）
    
7. 模型ID数检测

## 各功能使用说明

### 检测

> 此功能主要用于检测场景中丢失的贴图文件,(在勾选贴图大小检测后将具备检测贴图尺寸的功能。)
> 

- **此功能是替换功能的前置功能，需先执行后才能执行替换功能。**

- **点击一次**列表中的模型可使场景中的模型高亮。
- **双击两次**可将摄像机聚焦到模型上。

![image.png](/使用方式//imge/image.png)

- 

### 替换

> 此功能是替换丢失掉的贴图
> 

> 可以运用于重复贴图的批量替换。
> 
1. 将重复的贴图在maps文件中删除
2. 在max中点击检测,会出现丢失的结果

1. 可以选择进行替换，或者直接点击替换可直接点击替换。

**操作方式**

- 选择列表中模型点击替换时，只会对选择的模型进行替换贴图；其余模型不会发生更改。
- **不选择**则默认全部进行替换。

![image.png](/使用方式//imge/image%201.png)

### 更换贴图路径

> 此功能主要是对贴图路径的修改，查找因为路径不同而丢失的贴图链接。
> 

> 功能类似max中自带的**位图/光学路径中的功能。**
> 

**操作方式**

- **左键是更换检测出来丢失的贴图路径。**

- **右键**是对全部所有使用的贴图的路径进行更换。

![image.png](/使用方式//imge/image%202.png)

### 修复贴图尺寸

> **此功能需要先需要对全局贴图大小进行检测才可进行修复。**
> 

操作方式

- **选择**指定修复指定单个模型或多个模型的贴图尺寸。

- **不选择**会对检测出的全部贴图进行贴图修复。

![image.png](/使用方式//imge/image%203.png)

### 材质转换(标准/VR)

- 转换为标准材质；点击后默认对全局进行材质转换。
- 转化为VR材质，点击后默认对全局的材质进行材质转换**(此转换需要安装有VR渲染器)**

### 重命名工具

- 重命名功能：对模型/贴图进行批量重命名
- 将贴图名作为材质名：此功能**会将材质球的名称改为贴图的名称**，并去除材质名称的 T 字开头;
- 如果**材质为多维子材质**那么，主材质名称会改为模型名称。
- **勾选将贴图归档选项**后，在重命名贴图时会将贴图集中到max场景文件下的根目录的maps文件夹中。(如果已经存在那么

> 列如：
> 
> 
> 贴图名称：T_XX_XX_001
> 
> 运行后名称：MAT_XX_XX_001
> 

![image.png](/使用方式//imge/image%204.png)

重命名工具界面

![image.png](/使用方式//imge/image%205.png)

将贴图名作为材质名称功能效果图

### 模型ID数量检测

> 此功能主要是检测每个模型的ID数量即材质数，可以调节限位来进行过滤。
> 

# 🤗 总结

第一次开发max脚本，兜兜转转用了2个月，脚本目前还存在性能问题，后续可能还会继续优化。

> 如果你看到这里想着手优化脚本目前有这几个优化方向。
> 
> - 性能
>     - [ ]  大批量文件操作会造成整个软件的卡死，我想到的办法是分批了处理，在添加一个进度条。
>     - [ ]  错误处理机制不完善。
>     - [ ]  在多次操作时处理速度会极具下降，猜测时数组和缓存没有及时释放导致卡顿，脚本中只做了简单的内存清理，大批量操作文件时还是会有问题。
